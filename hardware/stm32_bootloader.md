# STM32 Bootloader

These instructions apply to all STM32 chips with built in USB and DFU features.

## Creating DFU file
TinyCLR OS build system will generate a bin file firmware that can be loaded using ST-Link for example. STM32 chips also include a USB bootloader that takes DFU files. To generate a DFU file, download the "DfuSe USB device firmware upgrade STMicroelectronics extension" software package from
http://www.st.com/en/development-tools/stsw-stm32080.html

1. find and open "Dfu file manager" and select "I want to generate a DFU file".
2. Click on "S19 or Hex..." button to select the hex file generated by the TinyCLR OS build system.
3. Click "Generate..."
4. You now have the DFU file!


## Uploading the DFU file
To set the STM32 chip in DFU mode, BOOT1 pin (if available) needs to be low and and BOOT0 needs to be high when the system powers up. If your system has a BOOT1 button, just hold the button down while powering the system up. The device manager will see the device "STM Device in DFU Mode".
1. Find and open "Open DfuSe Demo".
2. Under "Upgrade and Verify Action", click the "Chose..." button and select the firmware DFU file you want to load.
3. Click the "Upgrade" button.
4. Click the "Leave DFU mode" button.
5. Congratulations, your board is now running your firmware!
